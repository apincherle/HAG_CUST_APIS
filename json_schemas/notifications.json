{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "notifications",
    "properties": {
        "_metadata": {
            "type": "object",
            "description": "Sub-Document that stores the metadata of the notification.",
            "properties": {
                "creation_date": {
                    "type": "string",
                    "description": "The date at which the notification was created.\n\n---\n\nLDM Ref: Notification. Notification Datetime",
                    "examples": [
                        "ISODate(\"2021-10-11T11:50:00Z\")"
                    ],
                    "format": "date"
                },
                "creation_channel": {
                    "type": "string",
                    "description": "Channel used to make the notification, e.g. OutSystems.",
                    "examples": [
                        "OutSystems"
                    ]
                },
                "creation_user": {
                    "type": "string",
                    "description": "ID of the user that triggered the action that created the notification.",
                    "examples": [
                        "0f8fad5b-d9cb-469f-a165-70867728950e"
                    ],
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                },
                "modified_date": {
                    "type": "string",
                    "description": "The date at which the change was made. \n\nFor a notification, the only possible change is the user reading the notification or setting the notification as unread, in other words, altering the value of the read field.",
                    "examples": [
                        "ISODate(\"2021-12-11T11:50:00Z\")"
                    ],
                    "format": "date"
                },
                "modified_channel": {
                    "type": "string",
                    "description": "Channel used to make the change, e.g. OutSystems.",
                    "examples": [
                        "OutSystems"
                    ]
                },
                "modified_user": {
                    "type": "string",
                    "description": "ID of the user making the change. In this case, only the user that received the notification can change it to read/unread.",
                    "examples": [
                        "0f8fad5b-d9cb-469f-a165-70867728950e"
                    ],
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                }
            },
            "additionalProperties": false,
            "required": [
                "creation_date",
                "creation_channel",
                "creation_user",
                "modified_date",
                "modified_channel",
                "modified_user"
            ]
        },
        "_id": {
            "type": "string",
            "description": "A system-generated unique identifier for a Notification, with a format and structure defined by the technology used. As a technical attribute, it has no business meaning.\n\n---\n\nLDM Ref: Notification. Notification ID",
            "examples": [
                "0f8fad5b-d9cb-469f-a165-70867728950e"
            ],
            "maxLength": 36,
            "minLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
        },
        "category": {
            "type": "string",
            "description": "**Reference data**\n\nCategory of the Notification.\n\nThe current Notification Categories Available are:\n\nEndorsement,\nFacility,\nFirm Order,\nMisc,\nQuote,\nMI Report,\nSign & Close\n\nNotificationCategoryType tab -> https://pplnextgen.atlassian.net/wiki/spaces/PNG/pages/192872585/Codelist+Transactions+Notifications\n\n---\n\nLDM Ref: Notification. Notification Category Code",
            "examples": [
                "firm_order"
            ]
        },
        "action": {
            "type": "string",
            "description": "**Reference data**\n\nDenotes the type of Notification as a result of an action, operation, update or inaction (expiring) that has taken place or been triggered. \n\nThe current Notification Action Types available are:\n\nSubjectivity Satisfied,\nAccepted,\nAdditional Information,\nApproved,\nApproval Rejected,\nApproval Request,\nConditionally Accepted,\nSubjectivity Not Satisfied,\nReady to Download,\nFailed,\nFor Information Only,\nLead Agreed,\nMessage,\nSatisfaction Attempt,\nPublished,\nReassign,\nRejected,\nRequest,\nResponse,\nSigned Line,\nSubjectivity Amended,\nSubjectivity Expired,\nSubjectivity Expiring Soon,\nSubjectivity Reminder,\nUnderwriter Off Cover,\nUnpublished\n\nNotificationActionType tab -> https://pplnextgen.atlassian.net/wiki/spaces/PNG/pages/192872585/Codelist+Transactions+Notifications\n\n---\n\nLDM Ref: Notification. Notification Type Code",
            "examples": [
                "download_ready"
            ]
        },
        "sender": {
            "type": "object",
            "properties": {
                "_xid": {
                    "type": "string",
                    "description": "_id field of the user in the users collection.",
                    "examples": [
                        "0f8fad5b-d9cb-469f-a165-70867728950e"
                    ],
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                },
                "first_name": {
                    "type": "string",
                    "description": "The first name of the Sender",
                    "examples": [
                        "Hilary"
                    ]
                },
                "last_name": {
                    "type": "string",
                    "description": "The last name of the Sender.",
                    "examples": [
                        "Green"
                    ]
                },
                "organisation_name": {
                    "type": "string",
                    "description": "Name of the organisation the user belongs to. \nRemoves need for lookup when showing brokers and underwriters info under other collections context."
                },
                "company_name": {
                    "type": "string",
                    "description": "Name of the company the user belongs to. \nRemoves need for lookup when showing brokers and underwriters info under other collections context and keeps the company name the time the notification is created.\n\nLDM Ref: Notification.Organisation Name"
                }
            },
            "additionalProperties": false,
            "required": [
                "_xid",
                "first_name",
                "last_name",
                "organisation_name",
                "company_name"
            ]
        },
        "recipient": {
            "type": "object",
            "description": "Sub-Document that represents a recipient (User) by storing the user _xid and the user team_xid.",
            "properties": {
                "user_xid": {
                    "type": "string",
                    "description": "ID of the user that received the notification.\n\n--- \n\nLDM Reference: Notification. Receiver User ID",
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                },
                "first_name": {
                    "type": "string",
                    "description": "The first name of the Recipient.\n"
                },
                "last_name": {
                    "type": "string",
                    "description": "The last name of the Recipient.\n"
                },
                "team_xid": {
                    "type": "string",
                    "description": "The Team ID of the team the Recipient belongs to. A system-generated unique identifier for a Team, with a format and structure defined by the technology used.\n",
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                },
                "team_name": {
                    "type": "string",
                    "description": "The name of the Team the Recipient belongs to"
                },
                "organisation_xid": {
                    "type": "string",
                    "description": "_id of the organisation the underwriter belongs to.",
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                },
                "organisation_name": {
                    "type": "string",
                    "description": "Name of the organisation the recipient belongs to. \nRemoves need for lookup when showing brokers and underwriters info under other collections context."
                },
                "company_xid": {
                    "type": "string",
                    "description": "_id of the company the User belongs to.",
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                },
                "company_name": {
                    "type": "string",
                    "description": "Name of the company the user belongs to. \nRemoves need for lookup when showing brokers and underwriters info under other collections context and keeps the company name the time the notification is created.\n\nLDM Ref: Notification.Organisation Name"
                },
                "branch_xid": {
                    "type": "string",
                    "description": "_id of the branch the User belongs to.",
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                },
                "branch_name": {
                    "type": "string",
                    "description": "Name of the branch the user belongs to. \nRemoves need for lookup when showing brokers and underwriters info under other collections context."
                }
            },
            "additionalProperties": false,
            "required": [
                "user_xid",
                "first_name",
                "last_name",
                "team_xid",
                "team_name",
                "organisation_xid",
                "organisation_name",
                "company_xid",
                "company_name",
                "branch_xid",
                "branch_name"
            ]
        },
        "read": {
            "type": "boolean",
            "description": "Indicates whether the notification is read by the receiver or not.\n\n---\n\nLDM Ref: Notification. Notification Read Indicator"
        },
        "context": {
            "type": "object",
            "description": "Sub-document that stores the reference to the landing page. \n\nThis sub-document serves as the abstract structure to store references to the landing page, but in some cases, several references need to be stored for a single notification and that is where fields like contract_id and submission_id appear.",
            "properties": {
                "_xid": {
                    "type": "string",
                    "description": "ID of the object that notification points to. \n\nThis ID can point to several types of objects like Contract, Report, Section, Placement. \n\nThe object type is specified in the type field present in this sub-document.\n",
                    "maxLength": 36,
                    "minLength": 36,
                    "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                },
                "type": {
                    "type": "string",
                    "description": "Field to specify the object type, for the OS to fetch it and load the landing page."
                }
            },
            "additionalProperties": false,
            "required": [
                "_xid",
                "type"
            ]
        },
        "is_facility": {
            "type": "boolean",
            "description": "Field to inform if the notification is from a facility or not."
        },
        "is_technical": {
            "type": "boolean",
            "description": "Indicates whether the Notification is related to a technical event (true) or a business event (false).\n"
        },
        "process_status": {
            "type": "string",
            "description": "The code that represents the status of a technical, asynchronous event.\n"
        },
        "process_message": {
            "type": "string"
        },
        "name": {
            "type": "string",
            "description": "The description of the subjectivity to be shown in the notification OR the name of the report."
        },
        "expiry_date": {
            "type": "string",
            "description": "The expiry date of the subjectivity if the subjectivity has one.",
            "format": "date"
        },
        "description": {
            "type": "string",
            "description": "The description of the placement, programme, contract or section associated with the notification. \n\nThis works for both firm orders and endorsements."
        },
        "client_name": {
            "type": "string",
            "description": "The client name of the placement."
        },
        "contract_id": {
            "type": "string",
            "description": "Field that stores the reference to a contract. This field was created by the OutSystems Devs for notifications where the information in the context abstract structure is not sufficient for the OutSystems to change pages.",
            "maxLength": 36,
            "minLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
        },
        "submission_id": {
            "type": "string",
            "description": "Field that stores the reference to a submission. This field was created by the OutSystems Devs for notifications where the information in the context abstract structure is not sufficient for the OutSystems to change pages.",
            "maxLength": 36,
            "minLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
        },
        "section_id": {
            "type": "string",
            "description": "_id of section from placements collection",
            "examples": [
                "0f8fad5b-d9cb-469f-a165-70867728950e"
            ],
            "maxLength": 36,
            "minLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
        },
        "participation_id": {
            "type": "string",
            "description": "_id from Participations collection",
            "examples": [
                "0f8fad5b-d9cb-469f-a165-70867728950e"
            ],
            "maxLength": 36,
            "minLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
        },
        "programme_id": {
            "type": "string",
            "description": "Field that stores the reference to a programme.",
            "maxLength": 36,
            "minLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
        },
        "placement_id": {
            "type": "string",
            "description": "Field that stores the reference to a placement.",
            "maxLength": 36,
            "minLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
        },
        "contract_umr": {
            "type": "string",
            "description": "UMR of the contract. It should always be \"B\" + \"broker_code\" + \"broker_contract_ref\".\n\nNOTE: this field was added for XPR883 to extend the number of fields presented in a notification."
        },
        "documents": {
            "type": "array",
            "description": "Details on document attachments.\n\nNOTE: this field was added for XPR883 to extend the number of fields presented in a notification. In this array, we have two possibilities:\n\n - Only one document, saving the Placing Slip document (documents.type: 'document_placing_slip') \n\n - When the notification is related to endorsements, two documents will be saved: the Placing Slip one (where documents.type: 'document_placing_slip') and the Endorsement Slip one (where documents.type: 'document_placing_endorsement')",
            "additionalItems": false,
            "items": {
                "type": "object",
                "properties": {
                    "_xid": {
                        "type": "string",
                        "description": "_id of the Document to which we are referencing. \n\nNOTE: this field was added for XPR883 to extend the number of fields presented in a notification.",
                        "maxLength": 36,
                        "minLength": 36,
                        "pattern": "^$|^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                    },
                    "type": {
                        "type": "string"
                    },
                    "uri": {
                        "type": "string",
                        "description": "The UID of the document that links back to the physical location of the file.\n\nNOTE: this field was added for XPR883 to extend the number of fields presented in a notification.\n\n---\n\nLDM Ref: Document.Document UID",
                        "maxLength": 36,
                        "minLength": 36,
                        "pattern": "^$|^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$"
                    }
                },
                "additionalProperties": false,
                "required": [
                    "_xid",
                    "type",
                    "uri"
                ]
            }
        }
    },
    "additionalProperties": true,
    "required": [
        "_metadata",
        "_id",
        "category",
        "action",
        "sender",
        "recipient",
        "context"
    ]
}